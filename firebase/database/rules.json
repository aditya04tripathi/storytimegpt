{
	"rules": {
		"storyJobs": {
			"$jobId": {
				".read": "auth != null",
				".write": "auth != null && (!data.exists() || data.child('userId').val() == auth.uid)",
				"status": {
					".validate": "newData.isString() && (newData.val() == 'pending' || newData.val() == 'processing' || newData.val() == 'completed' || newData.val() == 'failed')"
				},
				"progress": {
					".validate": "newData.isNumber() && newData.val() >= 0 && newData.val() <= 100"
				},
				"userId": {
					".validate": "newData.isString() && newData.val() == auth.uid"
				}
			}
		},
		"users": {
			"$userId": {
				"notifications": {
					".read": "auth != null && auth.uid == $userId",
					".write": "auth != null && auth.uid == $userId",
					"$notificationId": {
						".validate": "newData.hasChildren(['message', 'type', 'timestamp'])"
					}
				}
			}
		}
	}
}

